<apex:page showHeader="false" standardController="Lead" extensions="getDataFromTracker"  tabStyle="account" >
    <apex:includeScript value="{!$Resource.JQuery}" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous"></link>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{!$Resource.customcss}"></link>
    <script>
    $( window ).load(function() {
        var leadId = document.getElementById('j_id0:j_id3:leadRecordId').value;
        jsRemoting(leadId);
    });

    var jsRemoting = function(leadId){
        Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.getDataFromTracker.tracker_Controller}',       // Accessing Class through remote action
            leadId,                                              			// Industry field value
            function(result,event){
                if(event.status){
                    for (var key in result) {
                        // skip loop if the property is from prototype
                        if (!result.hasOwnProperty(key)) continue;
                        var obj = result[key];
						console.log(obj);
						if(obj['rank'] === "1"){
							$('#accountOne').text(result[0].Name);
							$('#industryOne').text('Industry: ' + result[0].Industry);
							$('#actualRevenueCommitmentOne').text('Revenue: $' + result[0].Revenue);
							$('#boxesPerDayOne').text('Boxes per Day: ' + result[0].Industry);
							$('#ofProductSkusOne').text('Product SKU\'s: ' + result[0].Industry);
							$('#sicOne').text('SIC Code: ' + result[0].Industry);							
						} else if (obj['rank'] === "2"){
							$('#accountTwo').text(result[1].Name);
							$('#industryTwo').text('Industry: ' + result[1].Industry);
							$('#actualRevenueCommitmentTwo').text('Revenue: $' + result[1].Revenue);
							$('#boxesPerDayTwo').text('Boxes per Day: ' + result[1].Industry);
							$('#ofProductSkusTwo').text('Product SKU\'s: ' + result[1].Industry);
							$('#sicTwo').text('SIC Code: ' + result[1].Industry);
						}  else if (obj['rank'] === "3"){
							$('#accountThree').text(result[2].Name);
							$('#industryThree').text('Industry: ' + result[2].Industry);
							$('#actualRevenueCommitmentThree').text('Revenue: $' + result[2].Revenue);
							$('#boxesPerDayThree').text('Boxes per Day: ' + result[2].Industry);
							$('#ofProductSkusThree').text('Product SKU\'s: ' + result[2].Industry);
							$('#sicThree').text('SIC Code: ' + result[2].Industry);

						}
                    }
                } else {
                    console.log('Broken :' + result);
                }
            }
        )       
    }
    
    /*
        This function will handle lower case string and convert them into title case
    */
    var toTitleCase = function(str) {
        return str.replace(/(?:^|\s)\w/g, function(match) {
            return match.toUpperCase();
        });
    }
    
    var decimalFix = function(number){
        var a = parseFloat(number);
        return a.toFixed(2);
    }
    
    </script>
    <apex:form >
        <apex:inputHidden id="leadRecordId" value="{!Lead.Id}"/>
    </apex:form>
    <apex:outputPanel id="BoxTracker" layout="block">
        <div id="widgetHeader" class="image">
            <img src="http://www.packsize.com/wp-content/themes/packsize/images/packsize-logo-medium.png"></img>
        </div>        
        <div id="accordion" role="tablist" aria-multiselectable="true">
          <div class="card">
            <div class="card-header" role="tab" id="headingOne">
              <h5 class="mb-0">
                <a id="accountOne" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                  Account One
                </a>
              </h5>
            </div>
            <div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne">
              <div class="card-block">
                <div id="industryDivOne" class="table">
                    <span id="industryOne"></span>
                </div>
                <div id="annualCorrugateSpendDivOne" class="table">
                    <span id="actualRevenueCommitmentOne"></span>
                </div>
                <div id="boxesPerDayDivOne" class="table">
                    <span id="boxesPerDayOne"></span>
                </div>
				<div id="numberProductSkusDivOne" class="table">
                    <span id="ofProductSkusOne"></span>
                </div>
				<div id="sicCodeDivOne" class="table">
                    <span id="sicOne"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-header" role="tab" id="headingTwo">
              <h5 class="mb-0">
                <a id="accountTwo" class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  Account Two
                </a>
              </h5>
            </div>
            <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo">
              <div class="card-block">
                <div id="industryDivTwo" class="table">
                    <span id="industryTwo"></span>
                </div>
                <div id="annualCorrugateSpendDivTwo" class="table">
                    <span id="actualRevenueCommitmentTwo"></span>
                </div>
                <div id="boxesPerDayDivTwo" class="table">
                    <span id="boxesPerDayTwo"></span>
                </div>
				<div id="numberProductSkusDivTwo" class="table">
                    <span id="ofProductSkusTwo"></span>
                </div>
				<div id="sicCodeDivTwo" class="table">
                    <span id="sicTwo"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-header" role="tab" id="headingThree">
              <h5 class="mb-0">
                <a id="accountThree" class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                  Account Three
                </a>
              </h5>
            </div>
            <div id="collapseThree" class="collapse" role="tabpanel" aria-labelledby="headingThree">
              <div class="card-block">
                <div id="industryDivThree" class="table">
                    <span id="industryThree"></span>
                </div>
                <div id="annualCorrugateSpendDivThree" class="table">
                    <span id="actualRevenueCommitmentThree"></span>
                </div>
                <div id="boxesPerDayDivThree" class="table">
                    <span id="boxesPerDayThree"></span>
                </div>
				<div id="numberProductSkusDivThree" class="table">
                    <span id="ofProductSkusThree"></span>
                </div>
				<div id="sicCodeDivThree" class="table">
                    <span id="sicThree"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
    </apex:outputPanel>
</apex:page>